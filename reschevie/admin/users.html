<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Users â€” Reschevie Admin</title>
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,300;1,400&family=Montserrat:wght@300;400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/main.css">
</head>
<body>
<div class="admin-layout">
  <aside class="admin-sidebar">
    <div class="admin-sidebar-logo">
      <a href="../index.html" class="logo"><span class="logo-r">R</span>eschevie</a>
      <span>Admin Panel</span>
    </div>
    <nav class="admin-nav">
      <a href="index.html" class="admin-nav-item"><span class="admin-nav-icon">ğŸ“Š</span> Dashboard</a>
      <a href="products.html" class="admin-nav-item"><span class="admin-nav-icon">ğŸ’</span> Products</a>
      <a href="inquiries.html" class="admin-nav-item"><span class="admin-nav-icon">ğŸ“©</span> Inquiries</a>
      <a href="users.html" class="admin-nav-item active"><span class="admin-nav-icon">ğŸ‘¤</span> Users</a>
      <a href="stories.html" class="admin-nav-item"><span class="admin-nav-icon">ğŸ’¬</span> Client Stories</a>
      <a href="newsletters.html" class="admin-nav-item"><span class="admin-nav-icon">âœ‰ï¸</span> Newsletters</a>
      <div style="height:1px; background:rgba(197,160,112,0.1); margin:16px 0;"></div>
      <a href="../index.html" class="admin-nav-item"><span class="admin-nav-icon">ğŸŒ</span> View Site</a>
      <a href="#" class="admin-nav-item" id="logout-btn"><span class="admin-nav-icon">ğŸšª</span> Sign Out</a>
    </nav>
  </aside>
  <main class="admin-main">
    <div class="admin-header"><h1>Users</h1></div>
    <div class="admin-table-wrap">
      <div class="admin-table-header">
        <h3>Registered Users <span id="user-count" style="font-size:14px;color:var(--gray-light);font-family:var(--font-sans);"></span></h3>
      </div>
      <table>
        <thead><tr><th>Name</th><th>Email</th><th>Username</th><th>Phone</th><th>Role</th><th>Registered</th><th>Actions</th></tr></thead>
        <tbody id="users-table"></tbody>
      </table>
    </div>
  </main>
</div>
<script src="../js/data.js"></script>
<script>
document.addEventListener('DOMContentLoaded', () => {
  const session = getSession();
  if (!session || session.role !== 'admin') { window.location.href = '../login.html'; return; }
  document.getElementById('logout-btn').addEventListener('click', (e) => { e.preventDefault(); clearSession(); window.location.href = '../login.html'; });
  renderTable();
});
function renderTable() {
  const users = getUsers().filter(u => u.role !== 'admin');
  document.getElementById('user-count').textContent = `(${users.length})`;
  document.getElementById('users-table').innerHTML = users.length
    ? users.map(u => `<tr>
        <td><strong style="color:var(--white);">${u.fname} ${u.lname}</strong></td>
        <td>${u.email}</td>
        <td>@${u.username}</td>
        <td>${u.contact||'â€”'}</td>
        <td><span class="badge-status badge-available">${u.role}</span></td>
        <td>${formatDate(u.created_at)}</td>
        <td><button class="action-btn action-delete" onclick="deleteUser(${u.id})">Delete</button></td>
      </tr>`).join('')
    : `<tr><td colspan="7" style="text-align:center;color:var(--gray-light);padding:32px;">No users registered yet</td></tr>`;
}
function deleteUser(id) {
  if (!confirm('Delete this user? This cannot be undone.')) return;
  saveUsers(getUsers().filter(u => u.id !== id));
  renderTable();
  showToast('User deleted.');
}
</script>
</body>
</html>
